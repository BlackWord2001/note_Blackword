## 蓝图基础，组件机制，创建一个发光的发射物

1. 首先创建一个Actor，就叫发光球体或者 `GlowingSphere` 
2. 在左侧组件面板添加一个 球体组件 和 `发射物移动组件`
3. 再新建一个发光的材质球赋予给这个球体
    
    ![image](images/learn-1.png)

4. 添加以下蓝图

    <center>发光球体</center>

	![image](images/learn-2.png)

    <center>角色</center>
    
    ![image](images/learn-3.png)

    以上步骤中我们创建了一个名为 ==速度== 的变量，我们可以点击上方==类默认值==按钮跳转到类的细节面板可以看到==基础参数==下可以设置我们`速度`变量的值。

    ![image](images/learn-4.png)

    变量也不仅仅可以显示在`类默认值`下，也可以自己创建 `类别` 对变量进行分类。

    ![image](images/learn-5.png)


## 函数与参数，复制与继承，发射不同颜色的球

先把材质中的RGB的常量，转换为参数，并改名为`颜色`

![image](images/learn-6.png) | ![image](images/learn-7.png)
:--- | :---

之后在`内容浏览器`中右键材质并，选择`创建材质实例`，我们将会获得一个材质实例。虚幻引擎中的材质和材质实例就好比 `Unity`中的`Shader`和`材质`的关系。

![image](images/learn-8.png) | ![image](images/learn-9.png)
:--- | :---

点开我们新建的材质实例，把颜色参数设置为绿色。

![image](images/learn-10.png)

然后继续在`内容浏览器`选中这个材质实列，按下<kbd>Ctrl</kbd> - <kbd>D</kbd>复制一个新的材质实例，再把他的颜色属性修改为蓝色。
这样我们就获得了3个颜色的材质。

![image](images/learn-11.png)


接下来需要把这三个材质实例赋予给我们发光球体的Actor，需要再创建两个Actor但是和直接复制创建不同，我们这次需要用的是`创建蓝图子类`。

![image](images/learn-15.png)

再打开我们的`人物Actor`的蓝图，把之前连的蓝图节点全部折叠成函数

<center> [上一节课的效果] </center>

![image](images/learn-3.png)

选中除了 `输入的按键` 以外的节点，然后右键折叠到函数，就会发现他变成了一个节点。

![image](images/learn-12.png)

打开函数节点后我们把之前`生成Actor`节点上的`Class`的引脚拉到`发射球体`的节点上，这样就可以在外部就能看到`class`的节点选项

![image](images/learn-13.png)

![image](images/learn-14.png)

然后我们再创建另外两个按键输入，再把函数给复制两份，再把发射的Actor给选上就大功告成了。

![image](images/learn-17.png)

编译后运行游戏我们就能按`1` `2` `3`发射`红` `绿` `蓝`三种颜色的球体。


## 触发盒

本节要做一个球框，当球体穿过后会点亮绿色灯光的功能。

![image](./images/learn-18.png)

打开蓝图分别添加如下组件

![image](./images/learn-19.png)

把颜色设置为绿色，再把亮度提高。最后再关闭灯光的可视选项，因为我们之后需要使用蓝图启动这个选项。

![image](./images/learn-20.png)

选中Box碰撞体在（事件）中点击（组件开始重叠时）右侧的加号就能创建一个 （组件开始重叠时(Box)），然后在蓝图中添加如下图中的节点。可以发现本图中有两个延迟节点，分别是（延迟）和（可再触发式延迟）。

- 延迟：不管经过多少个球体，1秒的延迟结束后会关闭灯光。
- 可再触发延迟：每经过一个球会重新开始计时延迟，不会出现一直有球体经过却关闭灯光的情况。

![image](./images/learn-21.png)

角色在生成发光球体的时候因为碰撞的原因球体会挤压角色的空间从而导致角色位置偏移，所以需要再球体的（碰撞预设）中把（Pawn）设置为重叠或者忽略。

![image](./images/learn-22.png)


## 蓝图调试，两种延迟，用类型转换判断角色

下图红框部分的（未选中调试对象）设置为（触发区域）接下来只需要运行游戏就能开始调试了。当玩家射出球体到球框中，蓝图中的白线会变色出现如图的效果就代表已经被触发。

![image](./images/learn-23.png)

接下来需要把球框设置成当角色碰到触发体积并不会触发绿灯的效果，只需要从（组件开始重叠时(Box)）节点中的（Other Actor）引脚连出一个（类型转换）节点（BP_ThirdPersonCharacter）是我们的操控的角色，使用其中（Cast Failed - 强制转换失败）的引脚的意义就是让非玩家角色的物体都能触发灯光。

如果不使用（Cast Failed）引脚使用上方默认的引脚就可以做到只有玩家角色进入触发体积才能点亮灯光。

![image](./images/learn-24.png)