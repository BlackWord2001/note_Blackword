## 骨骼权重于顶点组的关系

当使用自动权重或者手动刷权重后相应的骨骼就会创建于骨骼名称相同的定点组。

![image](./Images/bone-1.png)

比如也可以查看单个顶点会具体受到哪个骨骼的影响，我们有两根骨骼已经和一根长方体进行了绑定并且其中是有权重的。如下图：图1中我们选中了其中一个顶点，然后打开我们右侧的n面板在条目下就会看到每个定点组对这单个顶点的权重值。

图1 | 图2 | 图3
:---: | :---: | :---: |
![image](./Images/bone-3.png) | ![image](./Images/bone-2.png) | ![image](./Images/bone-4.png)

如果只是看右边的参数其实还不够直观，我们可以在编辑模式下的时候从`3D视图标题栏` > `叠加`中启用`顶点组权重`的显示。这样我们就能像在`权重绘制`模式中一样直观的查看我们顶点组的强度。
把其中零权重的选项改为`活动项`的时候则这个定点组完全没有影响到的地方会显示成黑色能让我们更加直观的辨别。 

![image](./Images/bone-5.png)

在编辑模式下我们默认只能看见没有经过骨骼变换网格顶点，但是我们有些时候需要在编辑模型下操作并且要看到经过骨骼变换后的网格和顶点，就可以和下图一样在骨骼修改中打开以上两个选项分别是`调节编辑框到修改结果`和`在编辑模式显示修改器结果`。

![image](./Images/bone-6.png)


## 形态键
> 形态键用于制作动画将物体变形为新形态。 在其他术语中，形态键可能被称为 "形变目标" 或 "混合形态" 。
形态键最常用的用例是用在角色面部动画，以及用在调整和改进骨架绑定。 它们对于模拟有机柔软部位和肌肉建模特别有用，这里需要对结果形态进行更多控制，而这些控制不是旋转和缩放组合可以实现的。

ShapeKeys-1 | ShapeKeys-2
:-: | :-:
![形态健](./Images/ShapeKeys-1.png) | ![形态健](./Images/ShapeKeys-2.png)

`特殊形态健` > `混合后的新形态` 从当前状态的形态健顶点中创建一个新的形态健，相当于把当前状态另存为一个新的形态健。 


## 形态键驱动器

先建模一个嘴巴模型，再给嘴巴模型加上形态键分别命名为

1. Basis：基础形态
2. mouth_o：缩小嘴巴两遍宽度
3. mouth_happy：开心
4. mouth_sad：伤心
5. mouth_open：张大大嘴

![image](./Images/ShapeKeys-3.png)

驱动器编辑器窗口只要鼠标离开就会自动关闭，想要再打开可以右键已经添加驱动器的参数选择`Edit Driver` `编辑驱动器`。具体看下方图 `Driver-1`

然后图`Driver-2`中主要展示了形态键的参数设置，比较需要注意的点就是选择XYZ方向的时候请注意单段骨骼的局部朝向。具体看图`bone-7`

Driver-1 | Driver-2 | bone-7
:---: | :---: | :---:
![image](./Images/Driver-1.png) | ![image](./Images/Driver-2.png) | ![image](./Images/bone-7.png)

## 驱动器缩放控制旋转

制作一个缩放控制器，缩放控制器骨骼可以使目标骨骼进行旋转

![图片](./Images/驱动器-缩放骨骼旋转-1.webp)

```
## 驱动器表达式
(1-var)*pi

## 数据路径
pose.bones["骨骼名称"].scale.y
```

# <center>高级绑定课程笔记</center>

## 骨骼对称
Naming Conventions 命名习惯，在Blender命名习惯不仅仅是用于找到正确的骨骼，也告诉Blender哪两个骨骼是配对骨骼。

如果你的骨架可以镜像另一半（即它是两侧对称），这是值得坚持左/右命名的约定。这将使您能够使用一些工具，可能会节省您的时间和精力（如 X轴镜像 的编辑工具，我们上面看到的...）。

![形态健](./Images/animation_armatures_bones_editing_naming_example.png)

首先，你应该给你的骨骼有意义的基名称，如leg (腿部)，arm (手臂)，finger (手指)，back (背部)，foot (脚部)等。

如果你的骨骼的副本在另一边，像手臂，给它如下面的分隔符区别：

左/右分隔符可以是第二个位置 "L_calfbone"，也可以是最后一个位置 "calfbone.R"。

如果有一个大写或小写 L, R, left 或 right, Blender 正确处理副本。有关分隔符的列表，请参见下文。选择一个，当在绑定时尽量使用它们。会得到收获的。

    (nothing): handLeft --> handRight

    "_" (underscore): hand_L --> hand_R

    "." (dot): hand.l --> hand.r

    "-" (dash): hand-l --> hand-r

    " "（空格): 手向左 --> 手向右



## 形变（Deform）

我们在创建骨骼时有些骨骼是直接驱动模型的，而还有部分骨骼是用来当控制器使用的，所以关闭形变选项可以确保blender不会给我们创建多余的顶点组。

如果想要批量打开或者关闭（形变）选项，可以选择需要的骨骼然后按下 <kbd>Shift</kbd> - <kbd>W</kbd> ，会出现一个（打开骨骼设置）的面板，选择其中的（形变）

![形变](./Images/bone-9.png)

然后接着在屏幕的左下角的弹窗中选择（启用）或（禁用）

![形变](./Images/bone-10.png)

## 管理骨骼层

Blender自带的骨骼层比较老显得不那么直观，所以当前版本我会使用（Bone manger）插件拓展和提升我们工作的效率

插件下载地址请查看：[Blender-插件.md](../Blender-插件.md)

![BoneManger](./Images/BoneManager-1.png)

## 视图简化

因为我们的模型带细分修改器在姿态模式下k动作和播放动画可能会出现卡顿的现象，我们可以通过**简化** > **视图** 把 **最大细分** 设置到最小。

![视图细分简化](./Images/Simplify-Viewport-1.png)


## 隐藏不需要的面

如下图当我们在绘制权重的时候经常会遇到一个物体下但是模型的网格之前存在遮挡，导致我们绘制权重的时候就不是很方便。

![视图细分简化](./Images/隐藏网格-1.png)

想要隐藏网格也很简单，首先进入 __权重绘制__ 模式，选择视图左上角的绘制遮罩选项。

![视图细分简化](./Images/隐藏网格-2.png)

打开以上选项后我们就能在权重绘制模式中像编辑模式一样选择网格，按住<kbd>Ctrl</kbd>可以单选网格，<kbd>Shift</kbd>则是可以加选同时选中多个网格。

__单选__

![视图细分简化](./Images/隐藏网格-3.png) 

__多选__

![视图细分简化](./Images/隐藏网格-4.png)

假如我正在绘制胸口模型的权重，想隐藏掉其他所有网格。首选先选中胸口网格的其中一个网格面。

![视图细分简化](./Images/隐藏网格-5.png)

<kbd>Ctrl</kbd> + <kbd>L</kbd>，使用关联选择，这样相当于我们已经选中了一整个胸口的网格。

![视图细分简化](./Images/隐藏网格-6.png)

最后按下 <kbd>Shift</kbd> + <kbd>H</kbd> 隐藏未选中的网格。

![视图细分简化](./Images/隐藏网格-7.png)

在这最后复数一下，这个操作和编辑模式下是一样。

-  隐藏未选中的网格 
   - <kbd>Shift</kbd> + <kbd>H</kbd>
-  隐藏选中的网格 
   - <kbd>H</kbd>
-  取消隐藏 
   - <kbd>Alt</kbd> + <kbd>H</kbd>



